## 0x00 Exp
| 序号 | 类别     | 题目                                                         | 难度 | 要点                                                         |
| ---- | -------- | ------------------------------------------------------------ | ---- | ------------------------------------------------------------ |
| 1    | 基础运算 | Plaid CTF 2019 - R u SAd?<br> [Writeup](http://duksctf.github.io/2019/04/13/PlaidCTF2019-rusad.html) | 低   | 1. 函数egcd(x,y)返回值a,b,c，代表以下等式ax+by = c，利用该等式进行替换变形<br> |
|      |          |                                                              |      |                                                              |
|      |          |                                                              |      |                                                              |
|      |          |                                                              |      |                                                              |
|      |          |                                                              |      |                                                              |
|      |          |                                                              |      |                                                              |
|      |          |                                                              |      |                                                              |
|      |          |                                                              |      |                                                              |
|      |          |                                                              |      |                                                              |
|      |          |                                                              |      |                                                              |
|      |          |                                                              |      |                                                              |




## 0x01已知e,p,q求d
```	
d = gmpy2.invert(e, (p-1)*(q-1))
```
## 0x02 已知e,d,n求p,q
```
import random  
  
def gcd(a, b):  
   if a < b:  
     a, b = b, a  
   while b != 0:  
     temp = a % b  
     a = b  
     b = temp  
   return a  
  
def getpq(n,e,d):  
    p = 1  
    q = 1  
    while p==1 and q==1:  
        k = d * e - 1  
        g = random.randint ( 0 , n )  
        while p==1 and q==1 and k % 2 == 0:  
            k /= 2  
            y = pow(g,k,n)  
            if y!=1 and gcd(y-1,n)>1:  
                p = gcd(y-1,n)  
                q = n/p  
    return p,q  
  
def main():  
 
    n = 0xa66791dc6988168de7ab77419bb7fb0c001c62710270075142942e19a8d8c51d053b3e3782a1de5dc5af4ebe99468170114a1dfe67cdc9a9af55d655620bbab  
    e =  0x10001
    d =  0x123c5b61ba36edb1d3679904199a89ea80c09b9122e1400c09adcf7784676d01d23356a7d44d6bd8bd50e94bfc723fa87d8862b75177691c11d757692df8881
    p,q = getpq(n,e,d)  
    print "p: "+hex(p)
    print "q: "+hex(q)  
  
if __name__ == '__main__':  
    main()
```
## 0x03 在线分解n
www.factordb.com

## 0x04 yafu分解n
## 0x05 公约数分解n
```
def gcd(a, b):
   if a < b:
     a, b = b, a
   while b != 0:
     temp = a % b
     a = b
     b = temp
   return a
n1=9051013965404084482870087864821455535159008696042953021965631089095795348830954383127323853272528967729311045179605407693592665683311660581204886571146327720288455874927281128121117323579691204792399913106627543274457036172455814805715668293705603675386878220947722186914112990452722174363713630297685159669328951520891938403452797650685849523658191947411429068829734053745180460758604283051344339641429819373112365211739216160420494167071996438506850526168389386850499796102003625404245645796271690310748804327
n2=13225948396179603816062046418717214792668512413625091569997524364243995991961018894150059207824093837420451375240550310050209398964506318518991620142575926623780411532257230701985821629425722030608722035570690474171259238153947095310303522831971664666067542649034461621725656234869005501293423975184701929729170077280251436216167293058560030089006140224375425679571181787206982712477261432579537981278055755344573767076951793312062480275004564657590263719816033564139497109942073701755011873153205366238585665743
print "p: "+str(gcd(n1,n2))
print "q1: "+str(n1/gcd(n1,n2))
print "q2: "+str(n2/gcd(n1,n2))
```
## 0x06 e=3时小明文攻击
```
   i=0
   while 1:
   if(gmpy2.root(c+i*N, 3)[1]==1):
      print gmpy2.root(c+i*N, 3)
      break
   i=i+1
```

