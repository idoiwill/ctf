| 序号 | 类别     | 题目                                                         | 难度 | 要点                                                         |
| ---- | -------- | ------------------------------------------------------------ | ---- | ------------------------------------------------------------ |
| 1    | 基础运算 | Plaid CTF 2019 - R u SAd?<br> [Writeup](http://duksctf.github.io/2019/04/13/PlaidCTF2019-rusad.html) | 低   | 1. 函数egcd(x,y)返回值a,b,c，表示等式a*x+b*y = c，利用该等式和已知变量进行替换变形，得到p/q；<br> 2.由于p和q都是素数，所以egcd的第三个返回值为1 |
| 2    | 基础运算 | ASIS CTF 2020 <br> Baby RSA<br>[Writeup](https://ctftime.org/writeup/22086) | 低   | 1. 已知变量是n,e,c以及变换后的q和p，需要找出t_q和t_p与n的关系，从而算出q、p，再进一步解密 |
|      |          |                                                              |      |                                                              |
|      |          |                                                              |      |                                                              |
|      |          |                                                              |      |                                                              |
|      |          |                                                              |      |                                                              |
|      |          |                                                              |      |                                                              |
|      |          |                                                              |      |                                                              |
|      |          |                                                              |      |                                                              |
|      |          |                                                              |      |                                                              |
|      |          |                                                              |      |                                                              |


## 0x01已知e,p,q求d
```	
d = gmpy2.invert(e, (p-1)*(q-1))
```
## 0x02 已知e,d,n求p,q
```
import random  
  
def gcd(a, b):  
   if a < b:  
     a, b = b, a  
   while b != 0:  
     temp = a % b  
     a = b  
     b = temp  
   return a  
  
def getpq(n,e,d):  
    p = 1  
    q = 1  
    while p==1 and q==1:  
        k = d * e - 1  
        g = random.randint ( 0 , n )  
        while p==1 and q==1 and k % 2 == 0:  
            k /= 2  
            y = pow(g,k,n)  
            if y!=1 and gcd(y-1,n)>1:  
                p = gcd(y-1,n)  
                q = n/p  
    return p,q  
  
def main():  
 
    n = 0xa66791dc6988168de7ab77419bb7fb0c001c62710270075142942e19a8d8c51d053b3e3782a1de5dc5af4ebe99468170114a1dfe67cdc9a9af55d655620bbab  
    e =  0x10001
    d =  0x123c5b61ba36edb1d3679904199a89ea80c09b9122e1400c09adcf7784676d01d23356a7d44d6bd8bd50e94bfc723fa87d8862b75177691c11d757692df8881
    p,q = getpq(n,e,d)  
    print "p: "+hex(p)
    print "q: "+hex(q)  
  
if __name__ == '__main__':  
    main()
```
## 0x03 在线分解n
www.factordb.com

## 0x04 yafu分解n
## 0x05 公约数分解n
```
def gcd(a, b):
   if a < b:
     a, b = b, a
   while b != 0:
     temp = a % b
     a = b
     b = temp
   return a
n1=9051013965404084482870087864821455535159008696042953021965631089095795348830954383127323853272528967729311045179605407693592665683311660581204886571146327720288455874927281128121117323579691204792399913106627543274457036172455814805715668293705603675386878220947722186914112990452722174363713630297685159669328951520891938403452797650685849523658191947411429068829734053745180460758604283051344339641429819373112365211739216160420494167071996438506850526168389386850499796102003625404245645796271690310748804327
n2=13225948396179603816062046418717214792668512413625091569997524364243995991961018894150059207824093837420451375240550310050209398964506318518991620142575926623780411532257230701985821629425722030608722035570690474171259238153947095310303522831971664666067542649034461621725656234869005501293423975184701929729170077280251436216167293058560030089006140224375425679571181787206982712477261432579537981278055755344573767076951793312062480275004564657590263719816033564139497109942073701755011873153205366238585665743
print "p: "+str(gcd(n1,n2))
print "q1: "+str(n1/gcd(n1,n2))
print "q2: "+str(n2/gcd(n1,n2))
```
## 0x06 e=3时小明文攻击
```
   i=0
   while 1:
   if(gmpy2.root(c+i*N, 3)[1]==1):
      print gmpy2.root(c+i*N, 3)
      break
   i=i+1
```


(65537, 94962786219973877605671132537403567692440509416563276506616937465179543052924213419303316878950508729240534157716515828692415753760423373275798742901898988091711366167453291093198455208486860434821584730289796756303755481427944050694278973935430950200226296421295480931709196450582971294555698582300017079681)
(59689554847874056093522894557358652275419512622217938321967925712006032474501517821545301024523968683202653811170349935486275898044517137549261264554824555797167281774084610432672417104059882911623049068014057766046112405707488652409101966085668874020827374430371692420243675165526553501764397026287669226197 : 107033494829289229556075885979462361899987322825365541933972703943968531588265195269186863548962298698045245724642422677734531754208372003685975037164535540426445912448882320720472359490662223819700396239242421138100987404819402823347620606193192681437735774631528857883666813248099478194217107430655559387177 : 1)
8473244269440509775740824389306887881298058795843414842956132145490099061637
(121129302483457450895608650552243558445281823578945131606244911986357957846615219093944273522931121330892846906255621900353518764908058240190274164398929651054604172934407880109536968954842096749981787715589575379360708665738113909945093611320464753611894436549704087447277644447804224219449061523879184664224, 3433993182244742933171077355577942754401256613289749464940723455338441506020894108372280289090874388382515726802296885002734697572085019743996840692246280, 7185352839224592554378149243106036192572722976910322898221597172526458478345990407760099409610815351585677931127109742103079498785227488769888006188378352)

